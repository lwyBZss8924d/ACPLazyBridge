# yaml-language-server: $schema=https://raw.githubusercontent.com/ast-grep/ast-grep/main/schemas/rule.json
files:
  - "**/*.rs"
  - "!**/tests/**"
  - "!**/tests/**/*.rs"
  - "!**/*_test.rs"
  - "!**/*_tests.rs"
  - "!**/test_*.rs"
  - "!**/benches/**"
  - "!**/examples/**"
id: rust-no-unwrap
language: Rust
message: Avoid unwrap()/expect() in non-test code; handle errors explicitly
note: |
  For inline tests in src files, use suppression comments:
  // ast-grep-ignore: rust-no-unwrap
  #[test]
  fn test_function() { ... }
rule:
  any:
    - pattern: $EXPR.unwrap()
    - pattern: $EXPR.expect($MSG)
severity: warning
